<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forgot Password - desiixvideo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      @keyframes gradient {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }
      .gradient-bg {
        background: linear-gradient(-45deg, #1a1a1a, #2d1b1b, #1a1a1a, #2d1b1b);
        background-size: 400% 400%;
        animation: gradient 15s ease infinite;
      }
    </style>
</head>
<body class="gradient-bg text-white min-h-screen flex items-center justify-center p-4">
    <div class="w-full max-w-md">
      <div class="text-center mb-8">
        <div class="flex items-center justify-center gap-3 mb-2">
          <svg width="50" height="50" viewBox="0 0 40 40">
            <defs>
              <linearGradient id="logoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#ef4444;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#ec4899;stop-opacity:1" />
              </linearGradient>
            </defs>
            <circle cx="20" cy="20" r="18" fill="url(#logoGradient)" opacity="0.2"/>
            <path d="M15 12 L15 28 L28 20 Z" fill="url(#logoGradient)"/>
            <circle cx="20" cy="20" r="18" fill="none" stroke="url(#logoGradient)" stroke-width="2"/>
          </svg>
          <h1 class="text-4xl font-black bg-gradient-to-r from-red-500 via-pink-500 to-red-500 bg-clip-text text-transparent tracking-tight">desiixvideo</h1>
        </div>
        <p class="text-gray-400">Reset your password</p>
      </div>
      
      <div class="bg-gray-900 bg-opacity-60 backdrop-blur-sm p-8 rounded-2xl border border-red-900 shadow-2xl">
        <h2 class="text-3xl font-bold mb-6 text-center">Forgot Password</h2>
        
        <div id="step1" class="space-y-4">
          <p class="text-gray-400 text-sm text-center mb-4">Enter your email and new password</p>
          <form id="resetForm" class="space-y-4">
            <div>
              <input type="email" id="email" placeholder="Email" required 
                class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 focus:border-red-500 focus:outline-none transition" />
            </div>
            <div>
              <input type="password" id="newPassword" placeholder="New Password" required minlength="6"
                class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 focus:border-red-500 focus:outline-none transition" />
            </div>
            <div>
              <input type="password" id="confirmPassword" placeholder="Confirm New Password" required minlength="6"
                class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 focus:border-red-500 focus:outline-none transition" />
            </div>
            <button type="submit" class="w-full p-3 bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-700 hover:to-pink-700 rounded-lg font-semibold transform hover:scale-105 transition">
              üîÑ Reset Password
            </button>
          </form>
        </div>
        
        <div id="result" class="mt-4 hidden"></div>
        
        <p class="mt-6 text-sm text-center text-gray-400">
          Remember your password? 
          <a href="/login.html" class="text-red-400 hover:text-red-300 font-semibold">Login</a>
        </p>
      </div>
    </div>

    <script>
      document.getElementById('resetForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const email = document.getElementById('email').value;
        const newPassword = document.getElementById('newPassword').value;
        const confirmPassword = document.getElementById('confirmPassword').value;
        const resultDiv = document.getElementById('result');
        
        if (newPassword !== confirmPassword) {
          resultDiv.className = 'mt-4 p-4 bg-red-900 border border-red-700 rounded-lg text-red-200';
          resultDiv.textContent = '‚ùå Passwords do not match!';
          resultDiv.classList.remove('hidden');
          return;
        }
        
        if (newPassword.length < 6) {
          resultDiv.className = 'mt-4 p-4 bg-red-900 border border-red-700 rounded-lg text-red-200';
          resultDiv.textContent = '‚ùå Password must be at least 6 characters!';
          resultDiv.classList.remove('hidden');
          return;
        }
        
        try {
          const response = await fetch('/api/auth/forgot-password', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email, newPassword })
          });
          
          const data = await response.json();
          
          if (response.ok) {
            resultDiv.className = 'mt-4 p-4 bg-green-900 border border-green-700 rounded-lg text-green-200';
            resultDiv.innerHTML = `
              ‚úÖ <strong>Password Reset Successful!</strong><br>
              You can now <a href="/login.html" class="underline">login</a> with your new password.
            `;
            resultDiv.classList.remove('hidden');
            document.getElementById('resetForm').style.display = 'none';
          } else {
            resultDiv.className = 'mt-4 p-4 bg-red-900 border border-red-700 rounded-lg text-red-200';
            resultDiv.textContent = '‚ùå ' + (data.message || 'Password reset failed');
            resultDiv.classList.remove('hidden');
          }
        } catch (err) {
          resultDiv.className = 'mt-4 p-4 bg-red-900 border border-red-700 rounded-lg text-red-200';
          resultDiv.textContent = '‚ùå Error: ' + err.message;
          resultDiv.classList.remove('hidden');
        }
      });
    </script>
</body>
</html>
